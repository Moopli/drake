# Basics #
Every roguelike needs some way to produce an infinite stream of random dungeons. Of course, these dungeons can hardly be randomly generated (that is, irreducibly complex, maximally information-dense) because then the fun of actually exploring such a dungeon would be nonpresent. Thus we have the unenviable task set before us of producing a certain _playable_ kind of randomness. So, in a dungeon, we'd get rooms, corridors, stairways and the like, whereas the overworld would see us with rivers, forests, "naturally shaped" islands and coastlines, and overworld monsters and whatnot.

# Dungeons #
Since the seminal _Rogue_, the main idea behind roguelike dungeons has been that of "rooms" (large open spaces meant for open combat), linked by "corridors" (paths which serve as chokepoints), giving some tactical heterogeneity to the miasma. Thus all dungeons are graphs of some sort. Thus, the chief concern of dungeon-building is that of managing graph density. That is, ensuring connectivity while not overconnecting.

After some experimentation, I found BSP tree dungeons to be, generally, good enough. The trees they produce are connected, while not looping about; so some tactical opportunities (like pillar-dancing) are removed right off the bat, but there are methods of getting around that.

Anyways, a BSP dungeon generator creates floors of differently sized rectangles, connected as nodes in a tree. It is trivial to fill each rectangle with an empty room, and replace the links with one-tile-wide corridors; but that makes for homogeneous dungeoning. Instead, let us borrow an idea from another one of the wiki pages, and use what we will term "location predicates" and "location brushes"; or rather just predicates and brushes. Now each of these acts upon a region of a map; a predicate taking an area and returning a boolean; a brush taking an area and modifying it somehow. If you're particularly bright; you'll notice that we can link the two -- iterate over a bunch of areas, and only apply the brush to those areas which satisfy the predicate.

So, with those tools in hand, we revisit our BSP tree of differently sized rectangles subdividing a space. Now, we can use a predicate such as "hasAreaBetween(30, 42)", and selectively apply a brush "makeThroneRoom()"; which would then place statues, a throne, courtiers, pillars, and the metal king slime. We could even nest predicates, such as a potential link-predicate "connectsAreasFulfillingPredicates(hasAreaBetween(30, 42), hasLengthBetween(15, 19))". As you can see, predicates can get powerful quickly. And of course, we can also apply predicates on an entire level, or even a dungeon: "isTownLevel()" would be very powerful, as would "isBossLevel()", "isBossDungeon()", isRacialDungeon("kobold") etc. Of course, this really isn't the place to list predicates and stuff, but these are examples so whatevs.

# Overworld #
Overworld generation is significantly more complicated. and less complicated. all depending on the sort of detail we're looking for, and whether we want infinite worlds. Actually, after giving it a bit of thought, it's only difficult to do both at once. For finite but realistic worlds, one could take the Dwarf Fortress route, and generate a high-level landform and biome map, then use simpler methods to populate any one area with requisite wildlife and trees and rocks once the PC gets close. The other route, much more easy, is to just forgo great realism and simply produce random splotches of stuff as the PC gets close to the edge of the already-generated. It _would_, however, be possible to merge the two, but with some difficulty -- A random process, easily extended in any direction, produces the high-level map data, then another random process populates each region when it's encountered. Of course, how do we create an effective biome generator?

Actually, that last question could be expanded a bit more -- there are surely some kinds of region we want our overworld to be divided into. For example, we could have jungles, deserts, regions where vile energies run strong, etc. Note that the last could overlap with others -- so we could have evil jungles, serene jungles (well, still savage, but due only to wildlife, not tentacled beasts and kobolds and hydralisks running rampant). We could even have civilizations -- regions where lots of mobs are of a particular sentient race, which has towns and everything.

That brings us to our next point -- towns. Situating towns above ground is just too damn difficult, and we'd already have the machinery available to make underground towns from dungeon generation mechanics. Maybe we could set our game in some sort of universe where people have good reasons for livings underground:
  * Nuclear fallout, already done to death (or some other disaster -- Smaug, or cosmic rays, or alien space bats)
  * Incessant desert heat (would make for cool mechanics -- you have to get underground every now and then so you don't boil, and day-night mechanics would make for awesome planning)
  * Incessantly biting cold winds (again, forcing you underground)
  * loads and loads of raiding baddies (meaning more mobs to slay -- less story, more slashing, I say)
  * the dark miasma which corrupts all it touches for too long (again, great mechanic, we could have some sort of corruption which decays with time and causes mutations and stuff when too strong -- in terms of mutations, other roguelikes lead by example)
  * Matters of race -- dwarves live underground because they live underground. Night creatures hate the light. etc.

Come to think of it, we could introduce a universe where the only civilizations are underground civilizations -- it's the people that had reason to bunch together in elaborate caves, which developed social systems and civilization, and each had some environmental reason to escape the outside wold, at least sometimes. the reasons could simply be those above (well, except nuclear fallout). Then you'd have like the forest elves who just wander amidst the trees, having no need to build stuff and simply having an outdoor civilization; versus the humans of the great sand sea, who hide out beneath the ground from burning, parched death.

This could be integrated into the region generation system easily -- a region could simply have some SURVIVAL\_ABOVEGROUND\_STATISTICAL\_ANOMALY flag set, meaning all except the harshest creatures hide out in dungeons; and there can be epic underground civs.